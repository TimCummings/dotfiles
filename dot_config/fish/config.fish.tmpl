# hydrate ENV variables from chezmoi data file
{{- range $key, $value := .env.shared }}
set -gx {{ $key }} {{ $value }}
{{- end }}

{{- if eq .chezmoi.os "darwin" }}
{{- range $key, $value := .env.macos }}
set -gx {{ $key }} {{ $value }}
{{- end }}
{{- else if eq .chezmoi.os "linux" }}
{{- range $key, $value := .env.linux }}
set -gx {{ $key }} {{ $value }}
{{- end }}
{{- end }}

{{- if eq .chezmoi.os "darwin" }}
fish_add_path $ANDROID_HOME/emulator
fish_add_path $ANDROID_HOME/tools
fish_add_path $ANDROID_HOME/tools/bin
fish_add_path $ANDROID_HOME/platform-tools
{{- end }}

# Make sure ~/.local/bin is at the front of $PATH
fish_add_path -m $HOME/.local/bin

if status is-interactive
  # Homebrew package manager
  {{- if eq .chezmoi.os "darwin" }}
  eval $(/opt/homebrew/bin/brew shellenv)
  {{- end }}
  mise activate fish | source
  fzf --fish | source
  starship init fish | source

  abbr -a psf 'ps aux | fzf'

  # git
  abbr -a g 'git'
  # following aliases also in gitconfig (able to use e.g. in vim, but requires a space after `g`)
  abbr -a ga 'git add'
  abbr -a gb 'git branch'
  abbr -a gbc 'git branch | cat'
  abbr -a gbf 'git checkout $(git branch | fzf)'
  abbr -a gc 'git commit -v'
  abbr -a gco 'git checkout'
  abbr -a gcp 'git cherry-pick'
  abbr -a gd 'git diff'
  abbr -a gdc 'git diff --cached'
  abbr -a gf 'git fetch'
  abbr -a gl 'git log'
  abbr -a gp 'git pull'
  abbr -a gr 'git rebase'
  abbr -a gri 'git rebase --interactive'
  abbr -a gsh 'git show'
  abbr -a gst 'git status'

  abbr -a lg lazygit
end
